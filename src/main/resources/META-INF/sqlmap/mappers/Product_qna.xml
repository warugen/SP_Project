<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Product_qna">
	<resultMap type="Product_qna" id="Product_qnaResult">
		<result property="pqcode" column="pqcode" />
		<result property="pqtitle" column="pqtitle" />
		<result property="pqcontent" column="pqcontent" />
		<result property="pqanswer" column="pqanswer" />
		<result property="pqsecret" column="pqsecret" />
		<result property="pqcomplete" column="pqcomplete" />
		<result property="pqdate" column="pqdate" />
		<result property="pcode" column="pcode" />
		<result property="cid" column="cid" />
	</resultMap>
	<insert id="writeQna" parameterType="Product_qna">
		INSERT INTO PRODUCT_QNA
		(pqcode,pqtitle,pqcontent,pqanswer,pqsecret,pqcomplete,pcode,cid)
		VALUES(PRODUCT_QNA_SEQ.nextval,#{pqtitle},#{pqcontent},#{pqanswer},
		#{pqsecret},#{pqcomplete},#{pcode},#{cid})
	</insert>
	<update id="replyQna">
		SELECT * FROM PRODUCT WHERE PCODE=#{pcode}
	</update>
	<update id="modifyQna" parameterType="Product_qna">
		UPDATE PRODUCT_QNA SET
		PQTITLE=#{pqcode},
		PQCONTENT=#{pqcontent},
		PQANSWER=#{pqanswer},
		PQSECRET=#{pqsecret},
		PQCOMPLETE=#{pqcomplete}
		WHERE PqCODE=#{pqcode} AND CID=#{cid}
	</update>
	<select id="productQnaList" resultMap="Product_qnaResult">
		SELECT * FROM (SELECT ROWNUM RN, A.* FROM 
		(SELECT * FROM PRODUCT_QNA WHERE PCODE='2' ORDER BY PQDATE DESC)A)
		WHERE RN BETWEEN #{startrow} AND #{endrow}
	</select>
	<delete id="deleteQna">
		DELETE FROM PRODUCT_QNA WHERE PCODE=#{pcode} AND CID=#{cid}
	</delete>
	<select id="getQna" parameterType="String" resultType="Product_qna">
		SELECT * FROM PRODUCT_QNA WHERE PQCODE=#{pqcode}
	</select>
	<select id="qnaCnt" resultType="int">
		SELECT COUNT(*) FROM PRODUCT_QNA WHERE PCODE='2'
	</select>
</mapper> 