<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Order_history">
	<resultMap type="Order_history" id="Order_historyResult">
		<result property="ocode" column="ocode" />
		<result property="oname" column="oname" />
		<result property="otel" column="otel" />
		<result property="opost" column="opost" />
		<result property="oaddr1" column="oaddr1" />
		<result property="oaddr2" column="oaddr2" />
		<result property="osum" column="osum" />
		<result property="otime" column="otime" />
		<result property="odelivery" column="odelivery" />
		<result property="ostatus" column="ostatus" />
		<result property="cid" column="cid" />
		<result property="pocode" column="pocode" />
		<result property="poname" column="poname" />
		<result property="ponet" column="ponet" />
		<result property="poprice" column="poprice" />
		<result property="typecode" column="typecode" />
		<result property="pcode" column="pcode" />
		<result property="odcode" column="odcode" />
		<result property="cuid" column="cuid" />
		<result property="odcount" column="odcount" />
		<result property="odunit" column="odunit" />
	</resultMap>
	<select id="orderList" resultMap="Sp_orderResult">
		<if test="schitem==poname">
			SELECT * FROM
			(SELECT ROWNUM RN, A.* FROM
			(SELECT
			SP.*,PO.*,ODCODE,CUID,ODCOUNT,ODUNIT FROM SP_ORDER SP, ORDER_DETAIL
			OD, PRODUCT_OPTION PO
			WHERE SP.OCODE=OD.OCODE AND OD.ODCODE=PO.POCODE
			AND PONAME LIKE '%'||#{schword}||'%' ORDER BY ONAME)A)
			WHERE RN
			BETWEEN #{startrow} AND #{endrow}
		</if>
		<if test="schitem==oname">
			SELECT * FROM
			(SELECT ROWNUM RN, A.* FROM
			(SELECT
			SP.*,PO.*,ODCODE,CUID,ODCOUNT,ODUNIT FROM SP_ORDER SP, ORDER_DETAIL
			OD, PRODUCT_OPTION PO
			WHERE SP.OCODE=OD.OCODE AND OD.ODCODE=PO.POCODE
			AND ONAME LIKE '%'||#{schword}||'%' ORDER BY ONAME)A)
			WHERE RN BETWEEN
			#{startrow} AND #{endrow}
		</if>
	</select>
</mapper>