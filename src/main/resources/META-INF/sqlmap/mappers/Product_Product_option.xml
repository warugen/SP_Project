<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Product_Product_option">
	<resultMap type="Product_Product_option" id="Product_Product_optionResult">
		<result property="pcode" column="pcode" />
		<result property="ptitle" column="ptitle" />
		<result property="pcontent" column="pcontent" />
		<result property="pimage1" column="pimage1" />
		<result property="pimage2" column="pimage2" />
		<result property="pimage3" column="pimage3" />
		<result property="mid" column="mid" />
		<result property="pocode" column="pocode" />
		<result property="poname" column="poname" />
		<result property="ponet" column="ponet" />
		<result property="poprice" column="poprice" />
		<result property="typecode" column="typecode" />
		<result property="postock" column="postock" />
	</resultMap>
	<!-- Join리스트 -->
	<select id="product_Product_optionList" parameterType="Product_Product_option" resultMap="Product_Product_optionResult">
		SELECT * FROM (SELECT ROWNUM RN, A.* FROM(SELECT p.*,(select min(poprice) FROM PRODUCT_OPTION where pcode = p.pcode) poprice from product p ORDER BY PTITLE DESC) A)
    		WHERE RN BETWEEN #{startrow} AND #{endrow}
	</select>
	<!-- 등록번호로 상품가져오기 -->
    <select id="getProduct" parameterType="String" resultType="Product">
    	<![CDATA[
    		SELECT * FROM (SELECT P.*, POCODE, PONAME, PONET, POPRICE, POSTOCK FROM PRODUCT_OPTION O, PRODUCT P WHERE P.PCODE=O.PCODE) WHERE PCODE=#{pcode}
    	]]>
    </select>
</mapper>